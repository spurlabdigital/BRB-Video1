<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Video mit Auto-Hide-Button + Preview</title>
  <style>
    html, body {
      margin:0; padding:0; height:100%;
      background:black; overflow:hidden; font-family:sans-serif;
    }

    /* Video erst nach Start sichtbar */
    video{
      width:100vw; height:100vh; object-fit:cover; display:none;
    }

    /* --- Overlay --- */
    #overlay{
      position:absolute; inset:0;
      display:flex; flex-direction:column; justify-content:center; align-items:center;
      z-index:2; color:white; font-size:32px;
      background:black;         /* Fallback, wird nach Screenshot transparent gesetzt */
    }
    #previewImage{
      position:absolute; inset:0;
      width:100%; height:100%; object-fit:cover;
      z-index:-1;               /* liegt hinter dem Text */
    }
    #overlayText{
      padding:10px 20px; border-radius:10px;
      background:rgba(0,0,0,.6);
    }

    /* --- Steuer‑Buttons --- */
    #pausePlayButton, #restartButton{
      position:absolute; padding:10px 20px; border-radius:8px;
      background:rgba(0,0,0,.4); color:white; font-size:20px; user-select:none;
      transition:opacity .3s ease; z-index:3;
    }
    #pausePlayButton{ bottom:20px; right:20px; }
    #restartButton  { bottom:20px; left:20px;  }
    #pausePlayButton.hidden, #restartButton.hidden{ opacity:0; }
    #pausePlayButton:active, #restartButton:active{ background:rgba(255,255,255,.2); }
  </style>
</head>
<body>

  <!-- Overlay mit Platz für Screenshot + Text -->
  <div id="overlay">
    <img id="previewImage" alt="Vorschaubild">
    <div id="overlayText">Zum Starten tippen</div>
  </div>

  <!-- Video (mit CORS, damit Canvas erlaubt ist) -->
  <video id="video" preload="auto" crossorigin="anonymous">
    <source src="https://gesellschaft-kultur-geschichte.de/wp-content/uploads/2_Allgemein_160903_final.mp4" type="video/mp4">
    Dein Browser unterstützt das Video‑Tag nicht.
  </video>

  <!-- Steuer‑Buttons -->
  <div id="pausePlayButton">⏸</div>
  <div id="restartButton">⭯</div>

  <script>
    const video          = document.getElementById('video');
    const overlay        = document.getElementById('overlay');
    const previewImage   = document.getElementById('previewImage');
    const overlayText    = document.getElementById('overlayText');
    const pausePlayBtn   = document.getElementById('pausePlayButton');
    const restartBtn     = document.getElementById('restartButton');
    let hideTimer;

    /* ---------- Erstes Frame holen ---------- */
    video.addEventListener('loadeddata', captureFirstFrame, { once:true });

    function captureFirstFrame(){
      /* Canvas in Speicherkontext erzeugen */
      const canvas = document.createElement('canvas');
      canvas.width  = video.videoWidth  || 1280;   // Fallback‑Größen
      canvas.height = video.videoHeight || 720;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

      /* Data‑URL extrahieren und als Bild setzen */
      try{
        const dataURL = canvas.toDataURL('image/jpeg');
        previewImage.src = dataURL;
        overlay.style.background = 'transparent';
      }catch(err){
        /* CORS‑Problem? → einfach Overlay schwarz lassen */
        console.warn('Screenshot nicht möglich (CORS):', err);
      }
    }

    /* ---------- Hilfsfunktionen ---------- */
    function showButtonsTemporarily(){
      pausePlayBtn.classList.remove('hidden');
      restartBtn  .classList.remove('hidden');
      clearTimeout(hideTimer);
      hideTimer = setTimeout(()=> {
        pausePlayBtn.classList.add('hidden');
        restartBtn  .classList.add('hidden');
      }, 5000);
    }

    function startVideo(){
      overlay.style.display = 'none';
      video.style.display   = 'block';
      pausePlayBtn.style.display = restartBtn.style.display = 'block';
      video.muted  = false;
      video.volume = 1.0;
      video.play();
      showButtonsTemporarily();
    }

    /* ---------- Event‑Listener ---------- */

    /* Erstes Tippen → Video starten */
    document.addEventListener('touchstart', startVideo, { once:true });

    /* Pause / Play */
    pausePlayBtn.addEventListener('touchstart', (e)=>{
      e.stopPropagation();
      if(video.paused){
        video.play();  pausePlayBtn.textContent='⏸';
      }else{
        video.pause(); pausePlayBtn.textContent='▶';
      }
      showButtonsTemporarily();
    });

    /* Restart → zurück zum Overlay */
    restartBtn.addEventListener('touchstart', (e)=>{
      e.stopPropagation();
      video.pause(); video.currentTime = 0;
      video.style.display = 'none';
      pausePlayBtn.style.display = restartBtn.style.display = 'none';
      pausePlayBtn.textContent = '⏸';
      overlay.style.display = 'flex';
      overlayText.textContent = 'Zum Starten tippen';
      clearTimeout(hideTimer);
    });

    /* Irgendwo tippen → Buttons kurz einblenden (außer Overlay) */
    document.addEventListener('touchstart', ()=>{
      if(overlay.style.display === 'flex' || overlay.style.display === '') return;
      showButtonsTemporarily();
    });

    /* Video zu Ende → zurück zum Overlay */
    video.addEventListener('ended', ()=>{
      video.pause(); video.currentTime = 0;
      video.style.display = 'none';
      pausePlayBtn.style.display = restartBtn.style.display = 'none';
      pausePlayBtn.textContent = '⏸';
      overlay.style.display = 'flex';
      overlayText.textContent = 'Zum Starten tippen';
      clearTimeout(hideTimer);
    });
  </script>

</body>
</html>
